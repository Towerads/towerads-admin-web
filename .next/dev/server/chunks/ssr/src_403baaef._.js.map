{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/slava/OneDrive/%D0%A0%D0%B0%D0%B1%D0%BE%D1%87%D0%B8%D0%B9%20%D1%81%D1%82%D0%BE%D0%BB/USL/towerads-admin-web/src/lib/api.ts"],"sourcesContent":["const API_URL = process.env.NEXT_PUBLIC_API_URL!;\r\n\r\nexport async function api(\r\n  path: string,\r\n  options: RequestInit = {}\r\n): Promise<any> {\r\n  const token =\r\n    typeof window !== \"undefined\"\r\n      ? localStorage.getItem(\"admin_token\")\r\n      : null;\r\n\r\n  const res = await fetch(`${API_URL}${path}`, {\r\n    ...options,\r\n    headers: {\r\n      \"Content-Type\": \"application/json\",\r\n      ...(token ? { Authorization: `Bearer ${token}` } : {}),\r\n      ...(options.headers || {}),\r\n    },\r\n  });\r\n\r\n  if (!res.ok) {\r\n    const text = await res.text();\r\n    throw new Error(text || `API error ${res.status}`);\r\n  }\r\n\r\n  return res.json();\r\n}\r\n"],"names":[],"mappings":";;;;AAAA,MAAM;AAEC,eAAe,IACpB,IAAY,EACZ,UAAuB,CAAC,CAAC;IAEzB,MAAM,QACJ,sCACI,0BACA;IAEN,MAAM,MAAM,MAAM,MAAM,GAAG,UAAU,MAAM,EAAE;QAC3C,GAAG,OAAO;QACV,SAAS;YACP,gBAAgB;YAChB,GAAI,sCAAQ,0BAAuC,CAAC,CAAC;YACrD,GAAI,QAAQ,OAAO,IAAI,CAAC,CAAC;QAC3B;IACF;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,QAAQ,CAAC,UAAU,EAAE,IAAI,MAAM,EAAE;IACnD;IAEA,OAAO,IAAI,IAAI;AACjB"}},
    {"offset": {"line": 29, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/slava/OneDrive/%D0%A0%D0%B0%D0%B1%D0%BE%D1%87%D0%B8%D0%B9%20%D1%81%D1%82%D0%BE%D0%BB/USL/towerads-admin-web/src/app/%28admin%29/creatives/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport { api } from \"@/lib/api\";\r\n\r\ntype CreativeStatus = \"pending\" | \"approved\" | \"rejected\" | \"frozen\";\r\n\r\ntype Creative = {\r\n  id: string;\r\n  type: string;\r\n  media_url: string;\r\n  status: CreativeStatus;\r\n  advertiser_email: string;\r\n  created_at: string;\r\n};\r\n\r\nexport default function CreativePage() {\r\n  const params = useParams<{ id: string }>();\r\n  const router = useRouter();\r\n  const id = params?.id;\r\n\r\n  const [creative, setCreative] = useState<Creative | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [actionLoading, setActionLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!id) return;\r\n    loadCreative();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [id]);\r\n\r\n  async function loadCreative() {\r\n    try {\r\n      setLoading(true);\r\n\r\n      const statuses: CreativeStatus[] = [\r\n        \"pending\",\r\n        \"approved\",\r\n        \"rejected\",\r\n        \"frozen\",\r\n      ];\r\n\r\n      for (const status of statuses) {\r\n        const res = await api(`/admin/creatives?status=${status}`);\r\n        const found = res.creatives?.find(\r\n          (c: Creative) => c.id === id\r\n        );\r\n        if (found) {\r\n          setCreative(found);\r\n          return;\r\n        }\r\n      }\r\n\r\n      router.replace(\"/creatives\");\r\n    } catch (e) {\r\n      console.error(\"Load creative error:\", e);\r\n      router.replace(\"/creatives\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function approveCreative() {\r\n    if (!creative) return;\r\n    setActionLoading(true);\r\n\r\n    await api(\"/admin/creatives/approve\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify({ creative_id: creative.id }),\r\n    });\r\n\r\n    router.push(\"/creatives\");\r\n  }\r\n\r\n  async function rejectCreative() {\r\n    if (!creative) return;\r\n\r\n    const reason = prompt(\"Reject reason:\");\r\n    if (!reason?.trim()) return;\r\n\r\n    setActionLoading(true);\r\n\r\n    await api(\"/admin/creatives/reject\", {\r\n      method: \"POST\",\r\n      body: JSON.stringify({\r\n        creative_id: creative.id,\r\n        reason: reason.trim(),\r\n      }),\r\n    });\r\n\r\n    router.push(\"/creatives\");\r\n  }\r\n\r\n  const statusUi = useMemo(() => {\r\n    if (!creative) return null;\r\n\r\n    switch (creative.status) {\r\n      case \"pending\":\r\n        return { label: \"Awaiting moderation\", color: \"#facc15\" };\r\n      case \"approved\":\r\n        return { label: \"Approved\", color: \"#22c55e\" };\r\n      case \"rejected\":\r\n        return { label: \"Rejected\", color: \"#ef4444\" };\r\n      default:\r\n        return { label: creative.status, color: \"#93c5fd\" };\r\n    }\r\n  }, [creative]);\r\n\r\n  if (loading) return <div className=\"page\">Loadingâ€¦</div>;\r\n  if (!creative || !statusUi) return null;\r\n\r\n  return (\r\n    <div className=\"page\">\r\n      <h1 style={{ marginBottom: 24 }}>Creative review</h1>\r\n\r\n      <div\r\n        style={{\r\n          display: \"grid\",\r\n          gridTemplateColumns: \"520px 1fr\",\r\n          gap: 28,\r\n        }}\r\n      >\r\n        <div\r\n          style={{\r\n            background: \"rgba(0,0,0,0.35)\",\r\n            borderRadius: 14,\r\n            padding: 14,\r\n          }}\r\n        >\r\n          <video\r\n            src={creative.media_url}\r\n            controls\r\n            style={{ width: \"100%\", borderRadius: 10 }}\r\n          />\r\n        </div>\r\n\r\n        <div\r\n          style={{\r\n            background: \"rgba(255,255,255,0.04)\",\r\n            borderRadius: 14,\r\n            padding: 22,\r\n          }}\r\n        >\r\n          <p>\r\n            <b>Status:</b>{\" \"}\r\n            <span style={{ color: statusUi.color, fontWeight: 700 }}>\r\n              {statusUi.label}\r\n            </span>\r\n          </p>\r\n\r\n          <p>\r\n            <b>Advertiser:</b> {creative.advertiser_email}\r\n          </p>\r\n          <p>\r\n            <b>Type:</b> {creative.type}\r\n          </p>\r\n          <p>\r\n            <b>Created:</b>{\" \"}\r\n            {new Date(creative.created_at).toLocaleString()}\r\n          </p>\r\n\r\n          {creative.status === \"pending\" && (\r\n            <div style={{ display: \"flex\", gap: 12, marginTop: 24 }}>\r\n              <button\r\n                onClick={approveCreative}\r\n                disabled={actionLoading}\r\n                style={{ background: \"#22c55e\", padding: \"10px 16px\" }}\r\n              >\r\n                Approve\r\n              </button>\r\n\r\n              <button\r\n                onClick={rejectCreative}\r\n                disabled={actionLoading}\r\n                style={{ background: \"#ef4444\", padding: \"10px 16px\" }}\r\n              >\r\n                Reject\r\n              </button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}