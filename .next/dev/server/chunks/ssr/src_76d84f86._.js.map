{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/slava/OneDrive/%D0%A0%D0%B0%D0%B1%D0%BE%D1%87%D0%B8%D0%B9%20%D1%81%D1%82%D0%BE%D0%BB/USL/towerads-admin-web/src/lib/api.ts"],"sourcesContent":["const API_URL = process.env.NEXT_PUBLIC_API_URL!;\r\n\r\nexport async function api(\r\n  path: string,\r\n  options: RequestInit = {}\r\n): Promise<any> {\r\n  const token =\r\n    typeof window !== \"undefined\"\r\n      ? localStorage.getItem(\"admin_token\")\r\n      : null;\r\n\r\n  const headers: HeadersInit = {\r\n    ...(token ? { Authorization: `Bearer ${token}` } : {}),\r\n    ...(options.headers || {}),\r\n  };\r\n\r\n  if (options.body) {\r\n    headers[\"Content-Type\"] = \"application/json\";\r\n  }\r\n\r\n  const res = await fetch(`${API_URL}${path}`, {\r\n    mode: \"cors\",              // üî• –í–ê–ñ–ù–û\r\n    credentials: \"include\",    // üî• –í–ê–ñ–ù–û (—É —Ç–µ–±—è cors —Å credentials)\r\n    ...options,\r\n    headers,\r\n  });\r\n\r\n  if (!res.ok) {\r\n    const text = await res.text();\r\n    throw new Error(text || `API error ${res.status}`);\r\n  }\r\n\r\n  return res.json();\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA,MAAM;AAEC,eAAe,IACpB,IAAY,EACZ,UAAuB,CAAC,CAAC;IAEzB,MAAM,QACJ,sCACI,0BACA;IAEN,MAAM,UAAuB;QAC3B,GAAI,sCAAQ,0BAAuC,CAAC,CAAC;QACrD,GAAI,QAAQ,OAAO,IAAI,CAAC,CAAC;IAC3B;IAEA,IAAI,QAAQ,IAAI,EAAE;QAChB,OAAO,CAAC,eAAe,GAAG;IAC5B;IAEA,MAAM,MAAM,MAAM,MAAM,GAAG,UAAU,MAAM,EAAE;QAC3C,MAAM;QACN,aAAa;QACb,GAAG,OAAO;QACV;IACF;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,QAAQ,CAAC,UAAU,EAAE,IAAI,MAAM,EAAE;IACnD;IAEA,OAAO,IAAI,IAAI;AACjB"}},
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/slava/OneDrive/%D0%A0%D0%B0%D0%B1%D0%BE%D1%87%D0%B8%D0%B9%20%D1%81%D1%82%D0%BE%D0%BB/USL/towerads-admin-web/src/app/%28admin%29/orders/%5Bid%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport { api } from \"@/lib/api\";\r\n\r\ntype Order = {\r\n  id: string;\r\n  status: string;\r\n  impressions_total: number;\r\n  impressions_left: number;\r\n  impressions_done: number;\r\n  price_usd: string;\r\n  advertiser_email: string;\r\n  creative_type: string;\r\n  media_url: string;\r\n  click_url: string;\r\n};\r\n\r\nexport default function OrderPage() {\r\n  const { id } = useParams<{ id: string }>();\r\n  const router = useRouter();\r\n\r\n  const [order, setOrder] = useState<Order | null>(null);\r\n  const [loading, setLoading] = useState(true);\r\n\r\n  async function load() {\r\n    try {\r\n      const res = await api(`/admin/orders/${id}`);\r\n      setOrder(res.order);\r\n    } catch (e) {\r\n      console.error(e);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function action(type: \"pause\" | \"resume\" | \"stop\") {\r\n    await api(`/admin/orders/${id}/${type}`, { method: \"POST\" });\r\n    load();\r\n  }\r\n\r\n  useEffect(() => {\r\n    load();\r\n  }, [id]);\r\n\r\n  if (loading) return <div className=\"page\">Loading...</div>;\r\n  if (!order) return <div className=\"page\">Order not found</div>;\r\n\r\n  const progress =\r\n    ((order.impressions_done / order.impressions_total) * 100).toFixed(1);\r\n\r\n  return (\r\n    <div className=\"page\">\r\n      <div className=\"page-header\">\r\n        <h1>Order</h1>\r\n        <button onClick={() => router.back()}>‚Üê Back</button>\r\n      </div>\r\n\r\n      <div className=\"card\">\r\n        <div className=\"order-meta\">\r\n          <div><b>ID:</b> {order.id}</div>\r\n          <div><b>Advertiser:</b> {order.advertiser_email}</div>\r\n          <div><b>Status:</b> {order.status}</div>\r\n          <div><b>Type:</b> {order.creative_type}</div>\r\n          <div><b>Price:</b> ${order.price_usd}</div>\r\n        </div>\r\n\r\n        <div className=\"order-progress\">\r\n          <div>\r\n            {order.impressions_done} / {order.impressions_total} impressions\r\n          </div>\r\n          <div className=\"progress-bar\">\r\n            <div\r\n              className=\"progress\"\r\n              style={{ width: `${progress}%` }}\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"order-video\">\r\n          <video\r\n            src={order.media_url}\r\n            controls\r\n            style={{ maxWidth: 400, borderRadius: 12 }}\r\n          />\r\n        </div>\r\n\r\n        <div className=\"order-actions\">\r\n          {order.status === \"active\" && (\r\n            <button onClick={() => action(\"pause\")}>Pause</button>\r\n          )}\r\n          {order.status === \"paused\" && (\r\n            <button onClick={() => action(\"resume\")}>Resume</button>\r\n          )}\r\n          {order.status !== \"completed\" && (\r\n            <button className=\"danger\" onClick={() => action(\"stop\")}>\r\n              Stop\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAmBe,SAAS;IACtB,MAAM,EAAE,EAAE,EAAE,GAAG,IAAA,+IAAS;IACxB,MAAM,SAAS,IAAA,+IAAS;IAExB,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,iNAAQ,EAAe;IACjD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IAEvC,eAAe;QACb,IAAI;YACF,MAAM,MAAM,MAAM,IAAA,wHAAG,EAAC,CAAC,cAAc,EAAE,IAAI;YAC3C,SAAS,IAAI,KAAK;QACpB,EAAE,OAAO,GAAG;YACV,QAAQ,KAAK,CAAC;QAChB,SAAU;YACR,WAAW;QACb;IACF;IAEA,eAAe,OAAO,IAAiC;QACrD,MAAM,IAAA,wHAAG,EAAC,CAAC,cAAc,EAAE,GAAG,CAAC,EAAE,MAAM,EAAE;YAAE,QAAQ;QAAO;QAC1D;IACF;IAEA,IAAA,kNAAS,EAAC;QACR;IACF,GAAG;QAAC;KAAG;IAEP,IAAI,SAAS,qBAAO,8OAAC;QAAI,WAAU;kBAAO;;;;;;IAC1C,IAAI,CAAC,OAAO,qBAAO,8OAAC;QAAI,WAAU;kBAAO;;;;;;IAEzC,MAAM,WACJ,CAAC,AAAC,MAAM,gBAAgB,GAAG,MAAM,iBAAiB,GAAI,GAAG,EAAE,OAAO,CAAC;IAErE,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;kCAAG;;;;;;kCACJ,8OAAC;wBAAO,SAAS,IAAM,OAAO,IAAI;kCAAI;;;;;;;;;;;;0BAGxC,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;;kDAAI,8OAAC;kDAAE;;;;;;oCAAO;oCAAE,MAAM,EAAE;;;;;;;0CACzB,8OAAC;;kDAAI,8OAAC;kDAAE;;;;;;oCAAe;oCAAE,MAAM,gBAAgB;;;;;;;0CAC/C,8OAAC;;kDAAI,8OAAC;kDAAE;;;;;;oCAAW;oCAAE,MAAM,MAAM;;;;;;;0CACjC,8OAAC;;kDAAI,8OAAC;kDAAE;;;;;;oCAAS;oCAAE,MAAM,aAAa;;;;;;;0CACtC,8OAAC;;kDAAI,8OAAC;kDAAE;;;;;;oCAAU;oCAAG,MAAM,SAAS;;;;;;;;;;;;;kCAGtC,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;;oCACE,MAAM,gBAAgB;oCAAC;oCAAI,MAAM,iBAAiB;oCAAC;;;;;;;0CAEtD,8OAAC;gCAAI,WAAU;0CACb,cAAA,8OAAC;oCACC,WAAU;oCACV,OAAO;wCAAE,OAAO,GAAG,SAAS,CAAC,CAAC;oCAAC;;;;;;;;;;;;;;;;;kCAKrC,8OAAC;wBAAI,WAAU;kCACb,cAAA,8OAAC;4BACC,KAAK,MAAM,SAAS;4BACpB,QAAQ;4BACR,OAAO;gCAAE,UAAU;gCAAK,cAAc;4BAAG;;;;;;;;;;;kCAI7C,8OAAC;wBAAI,WAAU;;4BACZ,MAAM,MAAM,KAAK,0BAChB,8OAAC;gCAAO,SAAS,IAAM,OAAO;0CAAU;;;;;;4BAEzC,MAAM,MAAM,KAAK,0BAChB,8OAAC;gCAAO,SAAS,IAAM,OAAO;0CAAW;;;;;;4BAE1C,MAAM,MAAM,KAAK,6BAChB,8OAAC;gCAAO,WAAU;gCAAS,SAAS,IAAM,OAAO;0CAAS;;;;;;;;;;;;;;;;;;;;;;;;AAQtE"}}]
}