{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/slava/OneDrive/%D0%A0%D0%B0%D0%B1%D0%BE%D1%87%D0%B8%D0%B9%20%D1%81%D1%82%D0%BE%D0%BB/USL/towerads-admin-web/src/lib/api.ts"],"sourcesContent":["const API_URL = process.env.NEXT_PUBLIC_API_URL!;\r\n\r\nexport async function api(\r\n  path: string,\r\n  options: RequestInit = {}\r\n): Promise<any> {\r\n  const token =\r\n    typeof window !== \"undefined\"\r\n      ? localStorage.getItem(\"admin_token\")\r\n      : null;\r\n\r\n  const headers: HeadersInit = {\r\n    ...(token ? { Authorization: `Bearer ${token}` } : {}),\r\n    ...(options.headers || {}),\r\n  };\r\n\r\n  if (options.body) {\r\n    headers[\"Content-Type\"] = \"application/json\";\r\n  }\r\n\r\n  const res = await fetch(`${API_URL}${path}`, {\r\n    mode: \"cors\",              // üî• –í–ê–ñ–ù–û\r\n    credentials: \"include\",    // üî• –í–ê–ñ–ù–û (—É —Ç–µ–±—è cors —Å credentials)\r\n    ...options,\r\n    headers,\r\n  });\r\n\r\n  if (!res.ok) {\r\n    const text = await res.text();\r\n    throw new Error(text || `API error ${res.status}`);\r\n  }\r\n\r\n  return res.json();\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAA,MAAM;AAEC,eAAe,IACpB,IAAY,EACZ,UAAuB,CAAC,CAAC;IAEzB,MAAM,QACJ,sCACI,0BACA;IAEN,MAAM,UAAuB;QAC3B,GAAI,sCAAQ,0BAAuC,CAAC,CAAC;QACrD,GAAI,QAAQ,OAAO,IAAI,CAAC,CAAC;IAC3B;IAEA,IAAI,QAAQ,IAAI,EAAE;QAChB,OAAO,CAAC,eAAe,GAAG;IAC5B;IAEA,MAAM,MAAM,MAAM,MAAM,GAAG,UAAU,MAAM,EAAE;QAC3C,MAAM;QACN,aAAa;QACb,GAAG,OAAO;QACV;IACF;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,QAAQ,CAAC,UAAU,EAAE,IAAI,MAAM,EAAE;IACnD;IAEA,OAAO,IAAI,IAAI;AACjB"}},
    {"offset": {"line": 34, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/slava/OneDrive/%D0%A0%D0%B0%D0%B1%D0%BE%D1%87%D0%B8%D0%B9%20%D1%81%D1%82%D0%BE%D0%BB/USL/towerads-admin-web/src/app/%28admin%29/orders/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport { api } from \"@/lib/api\";\r\n\r\n/* ================= TYPES ================= */\r\n\r\ntype OrderStatus = \"active\" | \"paused\" | \"completed\";\r\n\r\ntype Order = {\r\n  id: string;\r\n  title: string;\r\n  status: OrderStatus;\r\n  impressions_total: number;\r\n  impressions_left: number;\r\n  impressions_done: number;\r\n  price_usd: string;\r\n  creative_type: string;\r\n  advertiser_email: string;\r\n  created_at: string;\r\n};\r\n\r\n/* ================= PAGE ================= */\r\n\r\nexport default function OrdersPage() {\r\n  const router = useRouter();\r\n\r\n  const [orders, setOrders] = useState<Order[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n\r\n  // üîç –ø–æ–∏—Å–∫\r\n  const [query, setQuery] = useState(\"\");\r\n  // üéØ —Ñ–∏–ª—å—Ç—Ä —Å—Ç–∞—Ç—É—Å–∞\r\n  const [status, setStatus] = useState<OrderStatus | \"\">(\"\");\r\n\r\n  /* ---------- LOAD ORDERS ---------- */\r\n\r\n  async function loadOrders(q = query, s = status) {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n\r\n      const params = new URLSearchParams();\r\n      if (q) params.set(\"q\", q);\r\n      if (s) params.set(\"status\", s);\r\n\r\n      const res = await api(`/admin/orders?${params.toString()}`);\r\n      setOrders(res.items || []);\r\n    } catch (e: any) {\r\n      setError(e.message || \"Failed to load orders\");\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  /* ---------- AUTO SEARCH + FILTER (DEBOUNCE) ---------- */\r\n\r\n  useEffect(() => {\r\n    const t = setTimeout(() => {\r\n      loadOrders();\r\n    }, 300); // üëà debounce\r\n\r\n    return () => clearTimeout(t);\r\n  }, [query, status]);\r\n\r\n  /* ---------- ACTIONS ---------- */\r\n\r\n  async function orderAction(\r\n    id: string,\r\n    action: \"pause\" | \"resume\" | \"stop\"\r\n  ) {\r\n    await api(`/admin/orders/${id}/${action}`, { method: \"POST\" });\r\n    loadOrders();\r\n  }\r\n\r\n  /* ================= RENDER ================= */\r\n\r\n  return (\r\n    <div style={{ padding: 28 }}>\r\n      <h1 style={title}>Orders</h1>\r\n      <p style={subtitle}>Manage all creative orders</p>\r\n\r\n      {/* üîç SEARCH + FILTER */}\r\n      <div style={{ display: \"flex\", gap: 12, marginBottom: 16 }}>\r\n        <input\r\n          placeholder=\"Search by title / id / email\"\r\n          value={query}\r\n          onChange={(e) => setQuery(e.target.value)}\r\n          style={input}\r\n        />\r\n\r\n        <select\r\n          value={status}\r\n          onChange={(e) => setStatus(e.target.value as any)}\r\n          style={select}\r\n        >\r\n          <option value=\"\">all</option>\r\n          <option value=\"active\">active</option>\r\n          <option value=\"paused\">paused</option>\r\n          <option value=\"completed\">completed</option>\r\n        </select>\r\n      </div>\r\n\r\n      <div style={card}>\r\n        {/* HEADER */}\r\n        <div style={headerGrid}>\r\n          <div>Order</div>\r\n          <div>Advertiser</div>\r\n          <div>Type</div>\r\n          <div>Status</div>\r\n          <div>Impressions</div>\r\n          <div>Price</div>\r\n          <div>Actions</div>\r\n        </div>\r\n\r\n        {/* SKELETON */}\r\n        {loading &&\r\n          Array.from({ length: 5 }).map((_, i) => (\r\n            <SkeletonRow key={i} />\r\n          ))}\r\n\r\n        {/* ERROR */}\r\n        {error && (\r\n          <div style={{ padding: 16, color: \"#ff6b6b\" }}>{error}</div>\r\n        )}\r\n\r\n        {/* DATA */}\r\n        {!loading &&\r\n          !error &&\r\n          orders.map((o) => (\r\n            <div\r\n              key={o.id}\r\n              style={rowGrid}\r\n              onClick={() => router.push(`/orders/${o.id}`)}\r\n            >\r\n              <div style={link}>\r\n                {o.title || o.id.slice(0, 8) + \"‚Ä¶\"}\r\n              </div>\r\n\r\n              <div style={muted}>{o.advertiser_email}</div>\r\n              <div style={pill}>{o.creative_type}</div>\r\n              <StatusBadge status={o.status} />\r\n\r\n              <div style={mono}>\r\n                {o.impressions_done}/{o.impressions_total}\r\n              </div>\r\n\r\n              <div style={mono}>${o.price_usd}</div>\r\n\r\n              <div onClick={(e) => e.stopPropagation()}>\r\n                <Actions order={o} onAction={orderAction} />\r\n              </div>\r\n            </div>\r\n          ))}\r\n\r\n        {!loading && !error && orders.length === 0 && (\r\n          <div style={{ padding: 16, opacity: 0.6 }}>No orders</div>\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ================= COMPONENTS ================= */\r\n\r\nfunction Actions({\r\n  order,\r\n  onAction,\r\n}: {\r\n  order: Order;\r\n  onAction: (id: string, action: \"pause\" | \"resume\" | \"stop\") => void;\r\n}) {\r\n  return (\r\n    <div style={{ display: \"flex\", gap: 8 }}>\r\n      {order.status === \"active\" && (\r\n        <button style={btn} onClick={() => onAction(order.id, \"pause\")}>\r\n          Pause\r\n        </button>\r\n      )}\r\n\r\n      {order.status === \"paused\" && (\r\n        <button style={btn} onClick={() => onAction(order.id, \"resume\")}>\r\n          Resume\r\n        </button>\r\n      )}\r\n\r\n      {order.status !== \"completed\" && (\r\n        <button\r\n          style={{ ...btn, background: \"#3b1c1c\" }}\r\n          onClick={() => onAction(order.id, \"stop\")}\r\n        >\r\n          Stop\r\n        </button>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nfunction StatusBadge({ status }: { status: OrderStatus }) {\r\n  const map = {\r\n    active: { bg: \"rgba(46,204,113,.2)\", color: \"#7dffb6\" },\r\n    paused: { bg: \"rgba(241,196,15,.2)\", color: \"#ffe58f\" },\r\n    completed: { bg: \"rgba(149,165,166,.2)\", color: \"#ccc\" },\r\n  };\r\n\r\n  return (\r\n    <span\r\n      style={{\r\n        padding: \"4px 10px\",\r\n        borderRadius: 999,\r\n        fontSize: 12,\r\n        fontWeight: 700,\r\n        background: map[status].bg,\r\n        color: map[status].color,\r\n      }}\r\n    >\r\n      {status}\r\n    </span>\r\n  );\r\n}\r\n\r\nfunction SkeletonRow() {\r\n  return (\r\n    <div style={rowGrid}>\r\n      {Array.from({ length: 7 }).map((_, i) => (\r\n        <div key={i} style={skeleton} />\r\n      ))}\r\n    </div>\r\n  );\r\n}\r\n\r\n/* ================= STYLES ================= */\r\n\r\nconst title = { fontSize: 40, fontWeight: 900 };\r\nconst subtitle = { opacity: 0.7, marginBottom: 20 };\r\n\r\nconst input = {\r\n  flex: 1,\r\n  padding: \"10px 14px\",\r\n  borderRadius: 12,\r\n  background: \"rgba(255,255,255,0.08)\",\r\n  border: \"1px solid rgba(255,255,255,0.12)\",\r\n  color: \"#fff\",\r\n};\r\n\r\nconst select: React.CSSProperties = {\r\n  padding: \"10px 14px\",\r\n  borderRadius: 12,\r\n  background: \"#0f1220\",\r\n  border: \"1px solid rgba(255,255,255,0.15)\",\r\n  color: \"#fff\",\r\n  width: 140,\r\n  appearance: \"none\",\r\n  WebkitAppearance: \"none\",\r\n  MozAppearance: \"none\",\r\n  cursor: \"pointer\",\r\n};\r\n\r\n\r\nconst card = {\r\n  borderRadius: 18,\r\n  background: \"rgba(0,0,0,0.25)\",\r\n  border: \"1px solid rgba(255,255,255,0.08)\",\r\n  overflow: \"hidden\",\r\n};\r\n\r\nconst headerGrid = {\r\n  display: \"grid\",\r\n  gridTemplateColumns: \"1fr 1.4fr .6fr .8fr .9fr .6fr 1fr\",\r\n  padding: \"14px 16px\",\r\n  fontSize: 12,\r\n  opacity: 0.6,\r\n  borderBottom: \"1px solid rgba(255,255,255,0.06)\",\r\n};\r\n\r\nconst rowGrid = {\r\n  display: \"grid\",\r\n  gridTemplateColumns: \"1fr 1.4fr .6fr .8fr .9fr .6fr 1fr\",\r\n  padding: \"14px 16px\",\r\n  borderBottom: \"1px solid rgba(255,255,255,0.04)\",\r\n  alignItems: \"center\",\r\n  cursor: \"pointer\",\r\n};\r\n\r\nconst link = { fontWeight: 700 };\r\nconst muted = { opacity: 0.75, fontSize: 13 };\r\nconst pill = {\r\n  padding: \"4px 10px\",\r\n  borderRadius: 999,\r\n  background: \"rgba(255,255,255,0.08)\",\r\n  fontSize: 12,\r\n};\r\nconst mono = { fontFamily: \"monospace\" };\r\n\r\nconst btn = {\r\n  padding: \"6px 10px\",\r\n  borderRadius: 10,\r\n  background: \"rgba(255,255,255,0.08)\",\r\n  border: \"1px solid rgba(255,255,255,0.12)\",\r\n  cursor: \"pointer\",\r\n  fontSize: 12,\r\n};\r\n\r\nconst skeleton = {\r\n  height: 14,\r\n  borderRadius: 6,\r\n  background:\r\n    \"linear-gradient(90deg, rgba(255,255,255,.05), rgba(255,255,255,.15), rgba(255,255,255,.05))\",\r\n};\r\n"],"names":[],"mappings":"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"}}]
}