{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/slava/OneDrive/%D0%A0%D0%B0%D0%B1%D0%BE%D1%87%D0%B8%D0%B9%20%D1%81%D1%82%D0%BE%D0%BB/USL/towerads-admin-web/src/lib/api.ts"],"sourcesContent":["const API_URL = process.env.NEXT_PUBLIC_API_URL!;\r\n\r\nexport async function api(\r\n  path: string,\r\n  options: RequestInit = {}\r\n): Promise<any> {\r\n  const token =\r\n    typeof window !== \"undefined\"\r\n      ? localStorage.getItem(\"admin_token\")\r\n      : null;\r\n\r\n  const headers: HeadersInit = {\r\n    ...(token ? { Authorization: `Bearer ${token}` } : {}),\r\n    ...(options.headers || {}),\r\n  };\r\n\r\n  if (options.body) {\r\n    headers[\"Content-Type\"] = \"application/json\";\r\n  }\r\n\r\n  const res = await fetch(`${API_URL}${path}`, {\r\n    mode: \"cors\",              // üî• –í–ê–ñ–ù–û\r\n    credentials: \"include\",    // üî• –í–ê–ñ–ù–û (—É —Ç–µ–±—è cors —Å credentials)\r\n    ...options,\r\n    headers,\r\n  });\r\n\r\n  if (!res.ok) {\r\n    const text = await res.text();\r\n    throw new Error(text || `API error ${res.status}`);\r\n  }\r\n\r\n  return res.json();\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAgB;AAAhB,MAAM;AAEC,eAAe,IACpB,IAAY,EACZ,UAAuB,CAAC,CAAC;IAEzB,MAAM,QACJ,uCACI,aAAa,OAAO,CAAC,iBACrB;IAEN,MAAM,UAAuB;QAC3B,GAAI,QAAQ;YAAE,eAAe,CAAC,OAAO,EAAE,OAAO;QAAC,IAAI,CAAC,CAAC;QACrD,GAAI,QAAQ,OAAO,IAAI,CAAC,CAAC;IAC3B;IAEA,IAAI,QAAQ,IAAI,EAAE;QAChB,OAAO,CAAC,eAAe,GAAG;IAC5B;IAEA,MAAM,MAAM,MAAM,MAAM,GAAG,UAAU,MAAM,EAAE;QAC3C,MAAM;QACN,aAAa;QACb,GAAG,OAAO;QACV;IACF;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,QAAQ,CAAC,UAAU,EAAE,IAAI,MAAM,EAAE;IACnD;IAEA,OAAO,IAAI,IAAI;AACjB"}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/slava/OneDrive/%D0%A0%D0%B0%D0%B1%D0%BE%D1%87%D0%B8%D0%B9%20%D1%81%D1%82%D0%BE%D0%BB/USL/towerads-admin-web/src/app/%28admin%29/creatives/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useState } from \"react\";\r\nimport { api } from \"@/lib/api\";\r\n\r\ntype CreativeStatus = \"pending\" | \"approved\" | \"rejected\";\r\n\r\ntype Creative = {\r\n  id: string;\r\n  media_url: string;\r\n  advertiser_email: string;\r\n  status: CreativeStatus;\r\n  created_at: string;\r\n\r\n  pricing_name?: string;\r\n  impressions?: number;\r\n  price_usd?: number;\r\n};\r\n\r\nconst TABS: { key: CreativeStatus; label: string }[] = [\r\n  { key: \"pending\", label: \"New requests\" },\r\n  { key: \"approved\", label: \"Approved\" },\r\n  { key: \"rejected\", label: \"Rejected\" },\r\n];\r\n\r\nexport default function CreativesPage() {\r\n  const [activeTab, setActiveTab] = useState<CreativeStatus>(\"pending\");\r\n  const [creatives, setCreatives] = useState<Creative[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  const [selected, setSelected] = useState<Creative | null>(null);\r\n  const [actionLoading, setActionLoading] = useState(false);\r\n\r\n  // reject modal state\r\n  const [rejectReason, setRejectReason] = useState(\"\");\r\n\r\n  useEffect(() => {\r\n    loadCreatives();\r\n    // eslint-disable-next-line react-hooks/exhaustive-deps\r\n  }, [activeTab]);\r\n\r\n  async function loadCreatives() {\r\n    setLoading(true);\r\n    try {\r\n      const data = await api(`/admin/creatives?status=${activeTab}`);\r\n      setCreatives(data.creatives || []);\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }\r\n\r\n  async function approve(id: string) {\r\n    setActionLoading(true);\r\n    try {\r\n      await api(\"/admin/creatives/approve\", {\r\n        method: \"POST\",\r\n        body: JSON.stringify({ creative_id: id }),\r\n      });\r\n      setSelected(null);\r\n      loadCreatives();\r\n    } finally {\r\n      setActionLoading(false);\r\n    }\r\n  }\r\n\r\n  async function reject(id: string) {\r\n    if (!rejectReason.trim()) return;\r\n\r\n    setActionLoading(true);\r\n    try {\r\n      await api(\"/admin/creatives/reject\", {\r\n        method: \"POST\",\r\n        body: JSON.stringify({\r\n          creative_id: id,\r\n          reason: rejectReason.trim(),\r\n        }),\r\n      });\r\n      setRejectReason(\"\");\r\n      setSelected(null);\r\n      loadCreatives();\r\n    } finally {\r\n      setActionLoading(false);\r\n    }\r\n  }\r\n\r\n  return (\r\n    <div className=\"page\">\r\n      <div className=\"page-inner\">\r\n        <h1 style={{ marginBottom: 24 }}>Creatives moderation</h1>\r\n\r\n        {/* TABS */}\r\n        <div style={{ display: \"flex\", gap: 10, marginBottom: 24 }}>\r\n          {TABS.map((tab) => (\r\n            <button\r\n              key={tab.key}\r\n              onClick={() => setActiveTab(tab.key)}\r\n              style={{\r\n                padding: \"8px 16px\",\r\n                borderRadius: 999,\r\n                fontWeight: 700,\r\n                fontSize: 14,\r\n                background:\r\n                  activeTab === tab.key\r\n                    ? \"rgba(99,102,241,0.18)\"\r\n                    : \"rgba(255,255,255,0.04)\",\r\n                border:\r\n                  activeTab === tab.key\r\n                    ? \"1px solid rgba(99,102,241,0.4)\"\r\n                    : \"1px solid rgba(255,255,255,0.08)\",\r\n              }}\r\n            >\r\n              {tab.label}\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        {loading && <div>Loading‚Ä¶</div>}\r\n\r\n        {!loading && creatives.length === 0 && (\r\n          <div style={{ opacity: 0.6 }}>No creatives</div>\r\n        )}\r\n\r\n        {/* LIST */}\r\n        <div style={{ display: \"grid\", gap: 14 }}>\r\n          {creatives.map((c) => (\r\n            <div\r\n              key={c.id}\r\n              onClick={() => setSelected(c)}\r\n              style={{\r\n                display: \"grid\",\r\n                gridTemplateColumns: \"160px 1fr 120px\",\r\n                gap: 20,\r\n                alignItems: \"center\",\r\n                padding: 14,\r\n                borderRadius: 14,\r\n                cursor: \"pointer\",\r\n                background: \"rgba(255,255,255,0.03)\",\r\n                border: \"1px solid rgba(255,255,255,0.08)\",\r\n              }}\r\n            >\r\n              <video\r\n                src={c.media_url}\r\n                muted\r\n                preload=\"metadata\"\r\n                style={{\r\n                  width: \"100%\",\r\n                  height: 90,\r\n                  objectFit: \"cover\",\r\n                  borderRadius: 10,\r\n                  background: \"#000\",\r\n                }}\r\n              />\r\n\r\n              <div style={{ display: \"grid\", gap: 6 }}>\r\n                <div style={{ fontWeight: 700 }}>\r\n                  {c.advertiser_email}\r\n                </div>\r\n\r\n                {c.pricing_name && (\r\n                  <div style={{ fontSize: 13, opacity: 0.75 }}>\r\n                    {c.pricing_name} ¬∑{\" \"}\r\n                    {c.impressions?.toLocaleString()} views ¬∑ $\r\n                    {c.price_usd}\r\n                  </div>\r\n                )}\r\n\r\n                <div style={{ fontSize: 12, opacity: 0.5 }}>\r\n                  {new Date(c.created_at).toLocaleDateString()}\r\n                </div>\r\n              </div>\r\n\r\n              <div\r\n                style={{\r\n                  justifySelf: \"end\",\r\n                  padding: \"6px 10px\",\r\n                  borderRadius: 999,\r\n                  fontSize: 12,\r\n                  fontWeight: 700,\r\n                  background:\r\n                    c.status === \"pending\"\r\n                      ? \"rgba(250,204,21,0.15)\"\r\n                      : c.status === \"approved\"\r\n                      ? \"rgba(34,197,94,0.15)\"\r\n                      : \"rgba(239,68,68,0.15)\",\r\n                  color:\r\n                    c.status === \"pending\"\r\n                      ? \"#facc15\"\r\n                      : c.status === \"approved\"\r\n                      ? \"#22c55e\"\r\n                      : \"#ef4444\",\r\n                }}\r\n              >\r\n                {c.status}\r\n              </div>\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* MODAL */}\r\n      {selected && (\r\n        <div\r\n          onClick={() => {\r\n            setSelected(null);\r\n            setRejectReason(\"\");\r\n          }}\r\n          style={{\r\n            position: \"fixed\",\r\n            inset: 0,\r\n            background: \"rgba(0,0,0,0.65)\",\r\n            display: \"flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\",\r\n            zIndex: 1000,\r\n          }}\r\n        >\r\n          <div\r\n            onClick={(e) => e.stopPropagation()}\r\n            style={{\r\n              width: 900,\r\n              maxWidth: \"95%\",\r\n              background: \"#0b0b12\",\r\n              borderRadius: 20,\r\n              padding: 24,\r\n              display: \"grid\",\r\n              gridTemplateColumns: \"480px 1fr\",\r\n              gap: 24,\r\n              boxShadow: \"0 30px 80px rgba(0,0,0,0.6)\",\r\n            }}\r\n          >\r\n            <video\r\n              src={selected.media_url}\r\n              controls\r\n              style={{\r\n                width: \"100%\",\r\n                borderRadius: 14,\r\n                background: \"#000\",\r\n              }}\r\n            />\r\n\r\n            <div style={{ display: \"flex\", flexDirection: \"column\" }}>\r\n              <h2 style={{ marginBottom: 14 }}>Ad request</h2>\r\n\r\n              <div style={{ display: \"grid\", gap: 10 }}>\r\n                <div>\r\n                  <b>Advertiser:</b> {selected.advertiser_email}\r\n                </div>\r\n\r\n                {selected.pricing_name && (\r\n                  <div>\r\n                    <b>Tariff:</b>{\" \"}\r\n                    {selected.pricing_name} ¬∑{\" \"}\r\n                    {selected.impressions?.toLocaleString()} views\r\n                  </div>\r\n                )}\r\n\r\n                {selected.price_usd !== undefined && (\r\n                  <div\r\n                    style={{\r\n                      fontSize: 26,\r\n                      fontWeight: 900,\r\n                    }}\r\n                  >\r\n                    ${selected.price_usd}\r\n                  </div>\r\n                )}\r\n\r\n                <div style={{ fontSize: 13, opacity: 0.6 }}>\r\n                  Created:{\" \"}\r\n                  {new Date(selected.created_at).toLocaleString()}\r\n                </div>\r\n              </div>\r\n\r\n              {selected.status === \"pending\" && (\r\n                <>\r\n                  <textarea\r\n                    placeholder=\"Reject reason (required)\"\r\n                    value={rejectReason}\r\n                    onChange={(e) => setRejectReason(e.target.value)}\r\n                    style={{\r\n                      marginTop: 16,\r\n                      minHeight: 70,\r\n                      padding: 10,\r\n                      borderRadius: 10,\r\n                      background: \"rgba(255,255,255,0.04)\",\r\n                      border: \"1px solid rgba(255,255,255,0.12)\",\r\n                      color: \"#fff\",\r\n                    }}\r\n                  />\r\n\r\n                  <div\r\n                    style={{\r\n                      display: \"flex\",\r\n                      gap: 12,\r\n                      marginTop: \"auto\",\r\n                    }}\r\n                  >\r\n                    <button\r\n                      onClick={() => approve(selected.id)}\r\n                      disabled={actionLoading}\r\n                      style={{\r\n                        flex: 1,\r\n                        padding: \"12px\",\r\n                        borderRadius: 12,\r\n                        fontWeight: 800,\r\n                        background: \"rgba(34,197,94,0.18)\",\r\n                        color: \"#22c55e\",\r\n                        border: \"1px solid rgba(34,197,94,0.4)\",\r\n                      }}\r\n                    >\r\n                      Approve\r\n                    </button>\r\n\r\n                    <button\r\n                      onClick={() => reject(selected.id)}\r\n                      disabled={!rejectReason.trim() || actionLoading}\r\n                      style={{\r\n                        flex: 1,\r\n                        padding: \"12px\",\r\n                        borderRadius: 12,\r\n                        fontWeight: 800,\r\n                        background: \"rgba(239,68,68,0.18)\",\r\n                        color: \"#ef4444\",\r\n                        border: \"1px solid rgba(239,68,68,0.4)\",\r\n                        opacity: !rejectReason.trim() ? 0.5 : 1,\r\n                      }}\r\n                    >\r\n                      Reject\r\n                    </button>\r\n                  </div>\r\n                </>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\n"],"names":[],"mappings":"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"}}]
}