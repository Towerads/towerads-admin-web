{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/slava/OneDrive/%D0%A0%D0%B0%D0%B1%D0%BE%D1%87%D0%B8%D0%B9%20%D1%81%D1%82%D0%BE%D0%BB/USL/towerads-admin-web/src/lib/api.ts"],"sourcesContent":["const API_URL = process.env.NEXT_PUBLIC_API_URL!;\r\n\r\nexport async function api(\r\n  path: string,\r\n  options: RequestInit = {}\r\n): Promise<any> {\r\n  const token =\r\n    typeof window !== \"undefined\"\r\n      ? localStorage.getItem(\"admin_token\")\r\n      : null;\r\n\r\n  const headers: HeadersInit = {\r\n    ...(token ? { Authorization: `Bearer ${token}` } : {}),\r\n    ...(options.headers || {}),\r\n  };\r\n\r\n  if (options.body) {\r\n    headers[\"Content-Type\"] = \"application/json\";\r\n  }\r\n\r\n  const res = await fetch(`${API_URL}${path}`, {\r\n    mode: \"cors\",              // üî• –í–ê–ñ–ù–û\r\n    credentials: \"include\",    // üî• –í–ê–ñ–ù–û (—É —Ç–µ–±—è cors —Å credentials)\r\n    ...options,\r\n    headers,\r\n  });\r\n\r\n  if (!res.ok) {\r\n    const text = await res.text();\r\n    throw new Error(text || `API error ${res.status}`);\r\n  }\r\n\r\n  return res.json();\r\n}\r\n\r\n"],"names":[],"mappings":";;;;AAAgB;AAAhB,MAAM;AAEC,eAAe,IACpB,IAAY,EACZ,UAAuB,CAAC,CAAC;IAEzB,MAAM,QACJ,uCACI,aAAa,OAAO,CAAC,iBACrB;IAEN,MAAM,UAAuB;QAC3B,GAAI,QAAQ;YAAE,eAAe,CAAC,OAAO,EAAE,OAAO;QAAC,IAAI,CAAC,CAAC;QACrD,GAAI,QAAQ,OAAO,IAAI,CAAC,CAAC;IAC3B;IAEA,IAAI,QAAQ,IAAI,EAAE;QAChB,OAAO,CAAC,eAAe,GAAG;IAC5B;IAEA,MAAM,MAAM,MAAM,MAAM,GAAG,UAAU,MAAM,EAAE;QAC3C,MAAM;QACN,aAAa;QACb,GAAG,OAAO;QACV;IACF;IAEA,IAAI,CAAC,IAAI,EAAE,EAAE;QACX,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,IAAI,MAAM,QAAQ,CAAC,UAAU,EAAE,IAAI,MAAM,EAAE;IACnD;IAEA,OAAO,IAAI,IAAI;AACjB"}},
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/slava/OneDrive/%D0%A0%D0%B0%D0%B1%D0%BE%D1%87%D0%B8%D0%B9%20%D1%81%D1%82%D0%BE%D0%BB/USL/towerads-admin-web/src/app/%28admin%29/providers/%5Bprovider%5D/page.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport { useEffect, useMemo, useState } from \"react\";\r\nimport { useParams, useRouter } from \"next/navigation\";\r\nimport { api } from \"@/lib/api\";\r\n\r\ntype StatRow = {\r\n  provider: string;\r\n  impressions: number | string;\r\n  revenue: number | string;\r\n  cpm?: number | string;\r\n};\r\n\r\nexport default function ProviderDetailPage() {\r\n  const router = useRouter();\r\n  const params = useParams();\r\n  const provider = String(params?.provider || \"\").toLowerCase();\r\n\r\n  const [period, setPeriod] = useState<\"today\" | \"7d\" | \"30d\">(\"today\");\r\n  const [rows, setRows] = useState<StatRow[]>([]);\r\n  const [loading, setLoading] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (!provider) return;\r\n\r\n    setLoading(true);\r\n    api(`/admin/stats/providers?period=${period}`)\r\n      .then((r) => setRows(r?.stats ?? []))\r\n      .finally(() => setLoading(false));\r\n  }, [provider, period]);\r\n\r\n  const current = useMemo(() => {\r\n    const found = rows.find(\r\n      (r) => String(r.provider || \"\").toLowerCase() === provider\r\n    );\r\n    return (\r\n      found ?? {\r\n        provider,\r\n        impressions: 0,\r\n        revenue: 0,\r\n        cpm: 0,\r\n      }\r\n    );\r\n  }, [rows, provider]);\r\n\r\n  const impressions = Number(current.impressions || 0);\r\n  const revenue = Number(current.revenue || 0);\r\n\r\n  // –µ—Å–ª–∏ –±—ç–∫ –Ω–µ –ø—Ä–∏—Å–ª–∞–ª cpm ‚Äî —Å—á–∏—Ç–∞–µ–º\r\n  const cpmValue = current.cpm !== undefined ? Number(current.cpm || 0) : 0;\r\n\r\n  const prettyCPM =\r\n    impressions < 10\r\n      ? \"‚Äî\"\r\n      : `$${(current.cpm !== undefined ? cpmValue : (revenue / impressions) * 1000).toFixed(\r\n          2\r\n        )}`;\r\n\r\n  return (\r\n    <div className=\"page-inner\">\r\n      <div className=\"page-header\" style={{ display: \"flex\", gap: 16, alignItems: \"center\" }}>\r\n        <div style={{ flex: 1 }}>\r\n          <h1 className=\"page-title\" style={{ textTransform: \"capitalize\" }}>\r\n            {provider}\r\n          </h1>\r\n          <p className=\"page-subtitle\">Provider analytics for selected period</p>\r\n        </div>\r\n\r\n        <button className=\"btn-secondary\" onClick={() => router.push(\"/providers\")}>\r\n          Back\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"providers-summary\" style={{ marginBottom: 16 }}>\r\n        <div className=\"summary-item\">\r\n          <span className=\"summary-label\">Period</span>\r\n          <strong className=\"summary-value\">{period}</strong>\r\n        </div>\r\n\r\n        <div className=\"summary-item\">\r\n          <span className=\"summary-label\">Impressions</span>\r\n          <strong className=\"summary-value\">{impressions}</strong>\r\n        </div>\r\n\r\n        <div className=\"summary-item\">\r\n          <span className=\"summary-label\">Revenue</span>\r\n          <strong className=\"summary-value\">${revenue.toFixed(2)}</strong>\r\n        </div>\r\n\r\n        <div className=\"summary-item\">\r\n          <span className=\"summary-label\">CPM</span>\r\n          <strong className=\"summary-value\">{prettyCPM}</strong>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"table-card\">\r\n        <div style={{ padding: 16, display: \"flex\", gap: 8 }}>\r\n          {([\"today\", \"7d\", \"30d\"] as const).map((p) => (\r\n            <button\r\n              key={p}\r\n              className={`filter ${period === p ? \"active\" : \"\"}`}\r\n              onClick={() => setPeriod(p)}\r\n              type=\"button\"\r\n            >\r\n              {p}\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        <table className=\"table\">\r\n          <thead>\r\n            <tr>\r\n              <th>Provider</th>\r\n              <th>Impressions</th>\r\n              <th>Revenue ($)</th>\r\n              <th>CPM ($)</th>\r\n            </tr>\r\n          </thead>\r\n          <tbody>\r\n            <tr>\r\n              <td className=\"capitalize\">{provider}</td>\r\n              <td>{impressions}</td>\r\n              <td>${revenue.toFixed(2)}</td>\r\n              <td>{prettyCPM}</td>\r\n            </tr>\r\n          </tbody>\r\n        </table>\r\n\r\n        {loading && <div className=\"loading\">Loading‚Ä¶</div>}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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"}}]
}